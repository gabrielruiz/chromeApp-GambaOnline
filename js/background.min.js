chrome.browserAction.getTitle({},function(a){if(a==="Gamba FM"){chrome.browserAction.setIcon({path:"../icons/icon.png"})}});var ln=window.navigator.language||navigator.browserLanguage,data={streamUrl:"http://gambafm.lorini.net:10630/;",streamUrl2:"http://www.fm.net.ve:9000/GAMBAFM",streamType:"mp3"},streamMedia=new Object(),timeInterval=(60*1000)*60,timeReconnection=(60*1000)*5,reconnectionAttempts=10,reconnectingCounter=0,radioState="pause",timeOut=null,_t,jplayer_1;function initPlayer(){var a=false,b;streamMedia[data.streamType]=data.streamUrl;chrome.storage.local.get("sync",function(c){if(c.sync){chrome.storage.sync.get("volume",initSetVolume)}else{chrome.storage.local.get("volume",initSetVolume)}})}function initSetVolume(b){var a=b.volume;if(typeof a==="undefined"){a=0.7}settingPlayer(a)}function settingPlayer(a){jplayer_1.jPlayer({ready:function(){ready=true;playerState="ready";console.log(_t.LOG.LOADING_PLAYER)},play:function(b){SetTimeOut();playerState="play";console.log(_t.LOG.PLAYING_NOW)},pause:function(b){clearStreamBuffered();ClearTimeOut();playerState="pause";console.log(_t.LOG.PAUSING_PLAYER)},error:function(b){if(ready&&b.jPlayer.error.type==$.jPlayer.error.URL_NOT_SET){playStream();console.error(_t.ERROR.ERROR_URL_NOT_SET);return}if(ready&&b.jPlayer.error.type==$.jPlayer.error.URL){ReConnect(playerState);console.error(_t.ERROR.ERROR_URL_NOT_RESPONSE)}},swfPath:"jplayer",supplied:data.streamType,wmode:"window",solution:"html",smoothPlayBar:true,keyEnabled:true,volume:a,preload:"none"})}function playStream(){jplayer_1.jPlayer("setMedia",streamMedia).jPlayer("play");console.log(_t.LOG.STARTING_STREAMING)}function clearStreamBuffered(){jplayer_1.jPlayer("clearMedia");console.log(_t.LOG.CLEARING_BUFFER)}function SetTimeOut(c,b){if(timeOut!==null){ClearTimeOut()}var a=(typeof b!=="undefined")?b:timeInterval;if(typeof c!=="undefined"){timeOut=setTimeout(function(){console.log(_t.LOG.RUNNING_TIMEOUT);c()},a);return}timeOut=setTimeout(function(){console.log(_t.LOG.RUNNING_TIMEOUT);playStream()},a);console.log(_t.LOG.INITIALIZING_PLAY)}function ClearTimeOut(){clearTimeout(timeOut);timeOut=null;console.log(_t.LOG.CLEARING_TIMEOUT)}function ReConnect(b){var a=(typeof b!=="undefined")?b:"play";if(reconnectingCounter===reconnectionAttempts){reconnectingCounter=0;SetTimeOut(function(){ReConnect(b)},timeReconnection);return}if(reconnectingCounter%2===0){streamMedia[data.streamType]=data.streamUrl;jplayer_1.jPlayer("setMedia",streamMedia).jPlayer(a)}else{streamMedia[data.streamType]=data.streamUrl2;jplayer_1.jPlayer("setMedia",streamMedia).jPlayer(a)}reconnectingCounter++}function init(){var a;if(ln.match(/en\-.+/)){a="en-US"}else{a="es-AR"}return $.getJSON("../languages/"+a+".json")}$(document).ready(function(){jplayer_1=$("#jquery_jplayer_1");init().then(function(a){_t=a;initPlayer()})});chrome.browserAction.onClicked.addListener(function(a){if(radioState==="pause"){chrome.browserAction.setIcon({path:"../icons/iconPlay.png"});chrome.browserAction.setTitle({title:_t.APP.PLAYING_GAMBA_FM});radioState="play";playStream()}else{chrome.browserAction.setIcon({path:"../icons/iconPause.png"});chrome.browserAction.setTitle({title:_t.APP.PAUSED_GAMBA_FM});radioState="pause";jplayer_1.jPlayer(radioState)}});chrome.storage.onChanged.addListener(function(b,a){for(key in b){var c=b[key];if(key==="volume"){jplayer_1.jPlayer("volume",c.newValue)}console.log('Storage key "%s" in namespace "%s" changed. Old value was "%s", new value is "%s".',key,a,c.oldValue,c.newValue)}});
function initPlayer(){streamMedia[data.streamType]=data.streamUrl,chrome.storage.local.get("sync",function(e){e.sync?(console.log("Loading Volume from Sync Storage."),chrome.storage.sync.get("volume",initSetVolume)):0==e.sync?(console.log("Loading Volume from Local Storage."),chrome.storage.local.get("volume",initSetVolume)):(console.log("::Setting by default::"),chrome.storage.local.set({volume:.7,sync:!1},function(){console.log("Init in LOCAL storage."),initSetVolume()}))})}function initSetVolume(e){var t=.7,o="By default.";e&&e.volume&&(t=e.volume,o=""),console.log("Init Volume in "+t+". "+o),settingPlayer(t)}function settingPlayer(e){jplayer_1.jPlayer({ready:function(){ready=!0,playerState="ready",console.log(_t.LOG.LOADING_PLAYER)},play:function(e){SetTimeOut(),playerState="play",console.log(_t.LOG.PLAYING_NOW)},pause:function(e){clearStreamBuffered(),ClearTimeOut(),playerState="pause",console.log(_t.LOG.PAUSING_PLAYER)},error:function(e){return ready&&e.jPlayer.error.type==$.jPlayer.error.URL_NOT_SET?(playStream(),void console.error(_t.ERROR.ERROR_URL_NOT_SET)):void(ready&&e.jPlayer.error.type==$.jPlayer.error.URL&&(ReConnect(playerState),console.error(_t.ERROR.ERROR_URL_NOT_RESPONSE)))},swfPath:"jplayer",supplied:data.streamType,wmode:"window",solution:"html",smoothPlayBar:!0,keyEnabled:!0,volume:e,preload:"none"})}function playStream(){jplayer_1.jPlayer("setMedia",streamMedia).jPlayer("play"),console.log(_t.LOG.STARTING_STREAMING)}function clearStreamBuffered(){jplayer_1.jPlayer("clearMedia"),console.log(_t.LOG.CLEARING_BUFFER)}function SetTimeOut(e,t){null!==timeOut&&ClearTimeOut();var o="undefined"!=typeof t?t:timeInterval;return"undefined"!=typeof e?void(timeOut=setTimeout(function(){console.log(_t.LOG.RUNNING_TIMEOUT),e()},o)):(timeOut=setTimeout(function(){console.log(_t.LOG.RUNNING_TIMEOUT),playStream()},o),void console.log(_t.LOG.INITIALIZING_PLAY))}function ClearTimeOut(){clearTimeout(timeOut),timeOut=null,console.log(_t.LOG.CLEARING_TIMEOUT)}function ReConnect(e){var t="undefined"!=typeof e?e:"play";return reconnectingCounter===reconnectionAttempts?(reconnectingCounter=1,void SetTimeOut(function(){ReConnect(e)},timeReconnection)):(streamMedia[data.streamType]=data.streamUrl,reconnectingCounter%3===0&&"undefined"!=typeof data.streamUrl2&&(streamMedia[data.streamType]=data.streamUrl2),jplayer_1.jPlayer("setMedia",streamMedia).jPlayer(t),void reconnectingCounter++)}function init(){var e;return e=ln.match(/en\-.+/)?"en-US":"es-AR",$.getJSON("../languages/"+e+".json")}chrome.browserAction.getTitle({},function(e){"Gamba FM"===e&&chrome.browserAction.setIcon({path:"../icons/icon.png"})});var ln=window.navigator.language||navigator.browserLanguage,data={},streamMedia=new Object,timeInterval=36e5,timeReconnection=3e5,reconnectionAttempts=10,reconnectingCounter=0,radioState="pause",timeOut=null,_t,jplayer_1;!function(e){e.getJSON("https://raw.githubusercontent.com/gabrielruiz/chromeApp-GambaOnline/master/data.json",function(e){data=e,console.log("Using data.json")})}(jQuery),$(document).ready(function(){jplayer_1=$("#jquery_jplayer_1"),init().then(function(e){_t=e,initPlayer()})}),chrome.browserAction.onClicked.addListener(function(e){"pause"===radioState?(chrome.browserAction.setIcon({path:"../icons/iconPlay.png"}),chrome.browserAction.setTitle({title:_t.APP.PLAYING_GAMBA_FM}),radioState="play",playStream()):(chrome.browserAction.setIcon({path:"../icons/iconPause.png"}),chrome.browserAction.setTitle({title:_t.APP.PAUSED_GAMBA_FM}),radioState="pause",jplayer_1.jPlayer(radioState))}),chrome.storage.onChanged.addListener(function(e,t){chrome.storage.local.get("sync",function(o){var n=o.sync?"sync":"local";for(key in e){var a=e[key],r=a.newValue,l=a.oldValue;"volume"===key&&(t===n?(jplayer_1.jPlayer("volume",r),console.log("Update Volume in "+n+" to "+r)):console.log("Ignoring Volume updating because is set in "+n+" intead of "+t)),console.log('Storage key "%s" in namespace "%s" changed. Old value was "%s", new value is "%s".',key,t,l,r)}})});